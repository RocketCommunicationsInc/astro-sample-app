<link rel="import" href="/bower_components/polymer/polymer-element.html">

<script>
	class RuxPopUpMenu extends Polymer.Element {
		static get is() { return 'rux-pop-up-menu'; }
		
		static get properties() {
			return {
				orientation: {
					type: String
				},
				target: {
					type: Object,
					observer: "_targetChanged"
				}
			}
		}

		static get template() {
			return Polymer.html`
				<link rel="stylesheet" href="src/astro-components/rux-pop-up-menu.css">

				<div class$="rux-pop-up rux-pop-up--[[orientation]]">
					<ul>
						<li><a href>Option One</a></li>
						<li><a href>Option Two</a></li>
						<li><a href>Option Three</a></li>
						<li><a href>Option Four</a></li>
					</ul>
				</div>
			`;
		}

		constructor() {
			super();
		}

		connectedCallback() {
			super.connectedCallback();


		}

		disconnectedCallback() {
			super.disconnectedCallback();
		}

		ready() {
			super.ready();
		}

		// _serializeValue(value) {
  	// 	if (value instanceof MyCustomType) {
    // 		return value.toString();
  	// }
  	// 	return super._serializeValue(value);
		// }


		_targetChanged(e) {
			
			const _target = typeof(e) === 'string' ? this.getRootNode().getElementById(e) : e;
			

			const _targetBounds = _target.getBoundingClientRect();
			const _popBounds = this.getBoundingClientRect();
			
			let _style = document.head.appendChild(document.createElement('style'));
					_style.innerHTML = '#test::before { margin-left: 24px';
			let _left = _targetBounds.left;
			let _top = _targetBounds.bottom;


			/*
			var h3 = document.querySelector('h3'); 
  		var result = getComputedStyle(h3, ':after').content;
			*/
			
			let _div = this.shadowRoot.querySelector('div');
			console.log('_div',_div);
			let _indicator = window.getComputedStyle(_div, ':before');
			
			console.log('_indicator',_indicator.marginLeft);
			_indicator.marginLeft = "25px";
			console.log('_indicator',_indicator);
			// _indicator.setAttribute('margin-left','10px')

				/* console.log(this);
				console.log(this.getBoundingClientRect());
				console.log(window.innerWidth);
				console.log(window.innerHeight);
				console.log(_popBounds.width); */

				// move popup back on screen if it extends past window width
				if((_targetBounds.left + _popBounds.width) > window.innerWidth) {	
					_left = window.innerWidth - _popBounds.width;
					this.classLists.replace('rux-pop-up--')
				}

			const _css = `position: fixed; top: ${_top}px; left: ${_left}px`;
				this.setAttribute('style', _css);
				
			
		}
	}

	customElements.define(RuxPopUpMenu.is, RuxPopUpMenu);
</script>
