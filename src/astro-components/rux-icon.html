<!--

	How this works - in theory	

	The WC has a library:icon property that defines the library to select from
	and the specific icon. For Astro I think it makes sense right now to have
	the following libraries:
		1) Status - the standard 7 shape/color combos
		2) Advanced Status - the more complex status icons
		3) Astro Standard Elements - Close, settings, user, etc …

	The icon code parses the <rux-icon> looking for the library and icon
	Then the code looks inside the SVG document for a corresponding library and icon
	Then the code strips out that SVG and pushes that in to the Polymer App

		

	Where I’m stuck

//-->


<link rel="import" href="/bower_components/polymer/polymer.html">


<dom-module id="rux-icon">
	<template>
		<style>
			:host {
				display: inline-block;
				contain: content; /* This improves CSS performance see: https://developers.google.com/web/updates/2016/06/css-containment */
			}	
		</style>

		<svg>
			<use href="advanced-status:thermal"></use>
		</svg>

		<slot></slot>
	</template>



	<script>
		class RuxIcon extends Polymer.Element {
			static get is() { return 'rux-icon'; }
			static get properties() {
				return {
					icon: {
						type: String,
						observer: '_iconChanged'
					}, 
					src: String
				}
			}

			constructor() {
				super();

				
				
				// console.log('Rux Icon Loaded …');
				// console.log('_iconlibrary',_iconlibrary);
				// console.log('_iconset',_iconset);
				// console.log('---- thermal icon',_iconset['thermal']);
				
				
			}


			_createIconMap(lib) {
				console.log(lib);
				let icons = Object.create(null);
				lib.querySelectorAll('[id]')
					.forEach(function(icon) {
						icons[icon.id] = icon;
					});
				return icons;
			}




			connectedCallback() {
				console.log('Rux Icon Connected');
				super.connectedCallback();
			}



			disconnectedCallback() {
				console.log('Rux Icon Disconnected');
				super.disconnectedCallback();
			}


			_iconChanged(newIcon, oldIcon) {
				

				let parts = newIcon.split(':');
				console.log(parts);
				this._iconName = parts.pop();
				this._iconSetName = parts.pop();
				this._updateIcon();


				let _iconlibrary = document.querySelector(`rux-icon-library[name="${this._iconSetName}"]`);
				console.log('_iconlibrary',_iconlibrary);
				let _iconset = this._createIconMap(_iconlibrary);
				console.log('_iconset',_iconset);

				

				// console.log('Icon Changed or Inited', newIcon);
				// console.log(this);
				

				// this is from the iron icon set. What I think is happening here
				// is the “meta” thing is grabbing the icon set by name.
				// this._meta.byKey(this._iconsetName));
				
				// this['advanced-status'].setIcon(this, this._iconName);



			}

			_updateIcon() {
				console.log('updateIcon');
				
			}


			ready() {
				super.ready();
				// console.log('Rux Icon is ready');
			}
		}

		customElements.define(RuxIcon.is, RuxIcon);
	</script>

</dom-module>